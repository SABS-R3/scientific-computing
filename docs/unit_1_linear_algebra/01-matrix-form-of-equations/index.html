<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.78.2" />
    <meta name="description" content="An online course on Modelling and Scientific Computing in Python for the SABS:R3 Centre for Doctoral Training https://www.sabsr3.ox.ac.uk/">
<meta name="author" content="Martin Robinson">

    <link rel="shortcut icon" href="/ScientificComputingInMatlab/logos/dtc_hex.svg" type="image/x-icon" />

    <title>Matrix form of equations   Modelling and Scientific Computing</title>

    
    <link href="/scientific-computing/css/nucleus.css?1609437715" rel="stylesheet">
    <link href="/scientific-computing/css/fontawesome-all.min.css?1609437715" rel="stylesheet">
    <link href="/scientific-computing/css/hybrid.css?1609437715" rel="stylesheet">
    <link href="/scientific-computing/css/featherlight.min.css?1609437715" rel="stylesheet">
    <link href="/scientific-computing/css/perfect-scrollbar.min.css?1609437715" rel="stylesheet">
    <link href="/scientific-computing/css/auto-complete.css?1609437715" rel="stylesheet">
    <link href="/scientific-computing/css/atom-one-dark-reasonable.css?1609437715" rel="stylesheet">
    <link href="/scientific-computing/css/theme.css?1609437715" rel="stylesheet">
    <link href="/scientific-computing/css/hugo-theme.css?1609437715" rel="stylesheet">
    
    <link href="/scientific-computing/css/theme-dtc.css?1609437715" rel="stylesheet">
    
    

    <script src="/scientific-computing/js/jquery-3.3.1.min.js?1609437715"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
        delimiters: [
                  {left: "$$", right: "$$", display: true},
                  {left: "\\[", right: "\\]", display: true},
                  {left: "$", right: "$", display: false},
                  {left: "\\(", right: "\\)", display: false}
              ]
        });
    });
</script>



  </head>
  <body class="" data-url="/scientific-computing/unit_1_linear_algebra/01-matrix-form-of-equations/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="https://sabs-r3.github.io/scientific-computing/">
    <img src="/scientific-computing/logos/SABSR3.svg" alt="SABSR3 logo">
</a>
  

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/scientific-computing/js/lunr.min.js?1609437715"></script>
<script type="text/javascript" src="/scientific-computing/js/auto-complete.js?1609437715"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/sabs-r3.github.io\/scientific-computing\/";
    
</script>
<script type="text/javascript" src="/scientific-computing/js/search.js?1609437715"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/scientific-computing/unit_0_introduction/" title="Course introduction" class="dd-item
        
        
        
        ">
      <a href="/scientific-computing/unit_0_introduction/">
          Course introduction
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_0_introduction/01_course_overview/" title="Course Overview" class="dd-item ">
        <a href="/scientific-computing/unit_0_introduction/01_course_overview/">
        1. Course Overview
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_0_introduction/02_course_activities/" title="Course Activities" class="dd-item ">
        <a href="/scientific-computing/unit_0_introduction/02_course_activities/">
        2. Course Activities
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_0_introduction/03_getting_matlab/" title="Getting MATLAB" class="dd-item ">
        <a href="/scientific-computing/unit_0_introduction/03_getting_matlab/">
        3. Getting MATLAB
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/scientific-computing/unit_1_linear_algebra/" title="Direct Solvers and Matrix Decompositions" class="dd-item
        parent
        
        
        ">
      <a href="/scientific-computing/unit_1_linear_algebra/">
          <b>Day 1. </b>Direct Solvers and Matrix Decompositions
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_1_linear_algebra/01-matrix-form-of-equations/" title="Matrix form of equations" class="dd-item active">
        <a href="/scientific-computing/unit_1_linear_algebra/01-matrix-form-of-equations/">
        Matrix form of equations
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_1_linear_algebra/02-gaussian-elimination/" title="Gaussian Elimination" class="dd-item ">
        <a href="/scientific-computing/unit_1_linear_algebra/02-gaussian-elimination/">
        Gaussian Elimination
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_1_linear_algebra/03-matrix-decompositions/" title="Matrix decompositions" class="dd-item ">
        <a href="/scientific-computing/unit_1_linear_algebra/03-matrix-decompositions/">
        Matrix decompositions
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_1_linear_algebra/04-lu-decomposition/" title="LU decomposition" class="dd-item ">
        <a href="/scientific-computing/unit_1_linear_algebra/04-lu-decomposition/">
        LU decomposition
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_1_linear_algebra/06-cholesky-decomposition/" title="Cholesky decomposition" class="dd-item ">
        <a href="/scientific-computing/unit_1_linear_algebra/06-cholesky-decomposition/">
        Cholesky decomposition
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_1_linear_algebra/07-qr-decomposition/" title="QR decomposition" class="dd-item ">
        <a href="/scientific-computing/unit_1_linear_algebra/07-qr-decomposition/">
        QR decomposition
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/scientific-computing/unit_2_linear_algebra/" title="Sparse Matrices and Iterative Solvers" class="dd-item
        
        
        
        ">
      <a href="/scientific-computing/unit_2_linear_algebra/">
          <b>Day 2. </b>Sparse Matrices and Iterative Solvers
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_2_linear_algebra/01-sparse-matrices/" title="Sparse matrices" class="dd-item ">
        <a href="/scientific-computing/unit_2_linear_algebra/01-sparse-matrices/">
        Sparse matrices
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_2_linear_algebra/02-coo-matrix/" title="COOrdinate format" class="dd-item ">
        <a href="/scientific-computing/unit_2_linear_algebra/02-coo-matrix/">
        COOrdinate format
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_2_linear_algebra/03-finite-difference/" title="Finite Difference Matrix" class="dd-item ">
        <a href="/scientific-computing/unit_2_linear_algebra/03-finite-difference/">
        Finite Difference Matrix
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_2_linear_algebra/04-scipy-sparse/" title="Scipy.sparse and problems" class="dd-item ">
        <a href="/scientific-computing/unit_2_linear_algebra/04-scipy-sparse/">
        Scipy.sparse and problems
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_2_linear_algebra/05-iterative-methods/" title="Iterative methods" class="dd-item ">
        <a href="/scientific-computing/unit_2_linear_algebra/05-iterative-methods/">
        Iterative methods
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_2_linear_algebra/06-jacobi-relaxation-methods/" title="Jacobi and Relaxation Methods" class="dd-item ">
        <a href="/scientific-computing/unit_2_linear_algebra/06-jacobi-relaxation-methods/">
        Jacobi and Relaxation Methods
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_2_linear_algebra/07-conjugate-gradient-method/" title="Conjugate Gradient Method" class="dd-item ">
        <a href="/scientific-computing/unit_2_linear_algebra/07-conjugate-gradient-method/">
        Conjugate Gradient Method
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_2_linear_algebra/08-scipy.sparse.linalg/" title="Iterative solvers in Scipy" class="dd-item ">
        <a href="/scientific-computing/unit_2_linear_algebra/08-scipy.sparse.linalg/">
        Iterative solvers in Scipy
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/scientific-computing/unit_3_ode/" title="Solving ODEs" class="dd-item
        
        
        
        ">
      <a href="/scientific-computing/unit_3_ode/">
          <b>Day 3. </b>Solving ODEs
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/scientific-computing/unit_4_optimisation/" title="Non-linear Optimisation" class="dd-item
        
        
        
        ">
      <a href="/scientific-computing/unit_4_optimisation/">
          <b>Day 4. </b>Non-linear Optimisation
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_4_optimisation/01-nonlinear-optimisation/" title="Nonlinear Optimisation" class="dd-item ">
        <a href="/scientific-computing/unit_4_optimisation/01-nonlinear-optimisation/">
        Nonlinear Optimisation
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_4_optimisation/02-line-search-methods/" title="Line Search Methods" class="dd-item ">
        <a href="/scientific-computing/unit_4_optimisation/02-line-search-methods/">
        Line Search Methods
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_4_optimisation/03-trust-region-methods/" title="Trust Region Methods" class="dd-item ">
        <a href="/scientific-computing/unit_4_optimisation/03-trust-region-methods/">
        Trust Region Methods
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_4_optimisation/04-derivatite-free-methods/" title="Derivative-free methods" class="dd-item ">
        <a href="/scientific-computing/unit_4_optimisation/04-derivatite-free-methods/">
        Derivative-free methods
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_4_optimisation/05-finite-difference-method/" title="Finite difference method" class="dd-item ">
        <a href="/scientific-computing/unit_4_optimisation/05-finite-difference-method/">
        Finite difference method
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/scientific-computing/unit_4_optimisation/06-nelder-mead/" title="Nelder-Mead method" class="dd-item ">
        <a href="/scientific-computing/unit_4_optimisation/06-nelder-mead/">
        Nelder-Mead method
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/scientific-computing/unit_5_bayesian_inference/" title="Bayesian Inference" class="dd-item
        
        
        
        ">
      <a href="/scientific-computing/unit_5_bayesian_inference/">
          <b>Day 5. </b>Bayesian Inference
          
      </a>
      
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/scientific-computing/unit_6_projects/" title="Projects" class="dd-item
        
        
        
        ">
      <a href="/scientific-computing/unit_6_projects/">
          <b>Day 6-8. </b>Projects
          
      </a>
      
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                  
                  
                  
                  <div id="top-github-link">
                    <a class="github-link" title='Edit this page' href="https://github.com/SABS-R3/scientific-computing/blob/main/hugo_site/content/unit_1_linear_algebra/01-matrix-form-of-equations.md" target="blank">
                      <i class="fas fa-code-branch"></i>
                      <span id="top-github-link-text">Edit this page</span>
                    </a>
                  </div>
                  
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/scientific-computing/'></a> > <a href='/scientific-computing/unit_1_linear_algebra/'>Direct Solvers and Matrix Decompositions</a> > Matrix form of equations
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">

    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Matrix form of equations
            </h1>
          

        


<h2 id="systems-of-linear-equations">Systems of linear equations</h2>

<p>Linear algebra is largely concerned with representing, manipulating and solving large
systems of linear equations. Consider the following 2 linear equations:</p>

<p><span  class="math">\[
\begin{aligned}
a_1x+b_1y &= c_1, \quad (1)\\
a_2x+b_2y &= c_2, \quad (2)
\end{aligned}
\]</span></p>

<p>where the values $\;x\;$ and $\;y\;$ are to be found, and $\;a_1, \;b_1, \;a_2, \;b_2,
\;c_1\;$ and $\;c_2\;$ are given constants. We know that we can use linear combinations
of these two equations to solve this sytem for $\;x\;$ and $\;y\;$, like so:</p>

<p><span  class="math">\[
\begin{aligned}
 (1) \times b_2:~~~~~~~~~~~~~~~ b_2a_1x+b_2b_1y &=& b_2c_1, \quad (3)\\
  (2) \times b_1:~~~~~~~~~~~~~~~ b_1a_2x+b_1b_2y &=& b_1c_2, \quad (4)\\
  (3) - (4):~~~~~~~~~~~~~~~ b_2a_1x-b_1a_2x &=& b_2c_1-b_1c_2.
\end{aligned}
\]</span></p>

<h2 id="the-matrix">The Matrix</h2>

<p>We can also write these linear equations using a matrix. Matrices are structures that
allow us to more easily manipulate linear systems. While not particularly useful for
just 2 equations, using a matrix representation allows us to generalise to, say $N$
equations and $M$ unknowns, or to solve large systems of equations on a computer.</p>

<p>Consider the original system:</p>

<p><span  class="math">\[
\begin{aligned}
a_1x+b_1y &= c_1, \\
a_2x+b_2y &= c_2. 
\end{aligned}
\]</span></p>

<p>We rewrite this, in the form of a matrix as:</p>

<p><span  class="math">\[
\left(\begin{matrix}a_1&b_1\\ a_2&b_2\end{matrix}\right)
\left(\begin{matrix}x\\y\end{matrix}\right)
=\left(\begin{matrix}c_1\\ c_2 \end{matrix}\right).
\]</span></p>

<p>Think about how this form relates to the original linear system.</p>

<h2 id="geometry-of-linear-equations">Geometry of linear equations</h2>

<p>Consider the following system of equations</p>

<p><span  class="math">\[
\begin{aligned}
 x + -2y &= -1, \\
-x +  3y &=  3. 
\end{aligned}
\]</span></p>

<p>That is,</p>

<p><span  class="math">\[A = \left(\begin{matrix} 1 & -2 \\ -1 & 3\end{matrix}\right)\]</span></p>

<p>Plotting these two linear equations on a graph shows graphically the solution to this
equation given by</p>

<p><span  class="math">\[\left(\begin{matrix} x \\ y \end{matrix}\right) = A^{-1} \left(\begin{matrix} -1 \\ 3 
\end{matrix}\right) = \left(\begin{matrix} -1 \\ 3 \end{matrix}\right)\]</span></p>

<p><figure><img src="/scientific-computing/images/unit_01/01-sim1.svg" alt="single solution"></figure></p>

<p>Now lets consider two different system of equations represented by the matrix:</p>

<p><span  class="math">\[
A = \left(\begin{matrix} 1 & -2 \\ -1 & 2\end{matrix}\right)
\]</span></p>

<p><span  class="math">\[
\begin{aligned}
 x + -2y &= -1, \\
-x +  2y &=  3. \end{aligned}
\]</span></p>

<p>and</p>

<p><span  class="math">\[
\begin{aligned}
 x + -2y &= -1, \\
-x +  2y &=  1. \end{aligned}
\]</span></p>

<p><figure><img src="/scientific-computing/images/unit_01/01-sim2.svg" alt="(left) infinite solutions, (right) no 
solutions"></figure></p>

<p>The first gives the plot on the left, while the second, which has a different vector of
constants on the RHS, gives the plot on the right. You can see that depending on the
constants, the system of equations can have an infinite number of solutions, or no
solutions at all.</p>

<p>The matrix $A$ in this case is singular, and therefore does not have an inverse. Looking
at the equations again, you can see that the two rows of the matrix $A$ are multiples of
the other, and thus there is only <em>one</em> independent row. That is, the <em>rank</em> of the
matrix is one.</p>

<h2 id="singular-matrices">Singular matrices</h2>

<p>The <em>rank</em> of an $\;n\,\times\,n\;$ matrix $\;A\;$ is the number of linearly independent rows in $\;A\;$ (rows not combinations of other rows).</p>

<p>When $\;\text{rank}(A) &lt; n\;$ then</p>

<ul>
<li>The matrix is said to be 'rank deficient'</li>
<li>The system $\;A\textbf{x} = \textbf{b}\;$ has <em>fewer</em> equations than unknowns</li>
<li>The matrix is said to be singular</li>
<li>The matrix is said to be underdetermined</li>
<li>$A\;$ has no inverse</li>
<li>The determinant of $\;A\;$ is 0</li>
<li>The equation $\;A\textbf{u} = \textbf{0}\;$ has non-trivial solutions ($\textbf{u} \neq \textbf{0}$)</li>
</ul>

<h3 id="the-determinant">The determinant</h3>

<p>One way of solving a system of equations represented by $A x = b$ is to calculate the
<em>inverse</em> of A, giving the solution as $x = A^{-1} b$. This can be done by calculating
what is known as the <em>determinant</em> of $A$.</p>

<p>If</p>

<p><span  class="math">\[A = \left(\begin{matrix} p & q \\ r & s\end{matrix}\right)\]</span></p>

<p>then the <strong>determinant</strong> of A is:</p>

<p><span  class="math">\[|A| = ps-qr\]</span></p>

<p>The inverse of $A$ can be found using the determinant:</p>

<p><span  class="math">\[
A^{-1} = \frac{1}{ps-qr} \left(\begin{matrix} s & -q \\ -r & p\end{matrix}\right)
\]</span></p>

<p>Calculating the inverse of a matrix using its determinant can be very costly for larger
matrices, therefore other algorithms are used (e.g. Gaussian Elimination, which is
introduced in the next section)</p>

<p>If $|A| = 0$, A is said to be <strong>singular</strong> (have no inverse). Graphically, this is
represented by the parallel or non-intersecting lines in the figure above.</p>

<h3 id="using-python-to-calculate-the-inverse">Using Python to calculate the inverse</h3>

<p>To find $A^{-1}$  for</p>

<p><span  class="math">\[
A = \left(\begin{matrix}3&0&2\\ 3&0&-3\\ 0&1&-1\end{matrix}\right)
\]</span></p>

<p>you can using numpy like so:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">A <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">3</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>]])
np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>inv(A)</code></pre></div>
<p>Output:</p>
<pre><code>array([[ 0.2       ,  0.13333333,  0.        ],
       [-0.2       ,  0.2       ,  1.        ],
       [ 0.2       , -0.2       , -0.        ]])</code></pre>
<p>It doesn't always work. Consider the following system</p>

<p><span  class="math">\[
A = \left(\begin{matrix}1&1&1\\ 2&4&2\\ 7&10&7\end{matrix}\right)
\]</span></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">A <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">2</span>], [<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">7</span>]])
np<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>inv(A)</code></pre></div>
<p>Output:</p>
<pre><code>Traceback (most recent call last):
  File &#34;&lt;stdin&gt;&#34;, line 1, in &lt;module&gt;
  File &#34;&lt;__array_function__ internals&gt;&#34;, line 6, in inv
  File &#34;/home/mrobins/git/scientific-computing/env/lib/python3.6/site-packages/numpy/linalg/linalg.py&#34;, line 546, in inv
    ainv = _umath_linalg.inv(a, signature=signature, extobj=extobj)
  File &#34;/home/mrobins/git/scientific-computing/env/lib/python3.6/site-packages/numpy/linalg/linalg.py&#34;, line 88, in _raise_linalgerror_singular
    raise LinAlgError(&#34;Singular matrix&#34;)
numpy.linalg.LinAlgError: Singular matrix</code></pre>
<h2 id="other-reading">Other Reading</h2>

<ul>
<li>Linear algebra by Ward Cheney</li>
<li>Linear algebra and its applications by David C. Lay.</li>
<li>Strang, G. (2016). Introduction to linear algebra (Fifth ed.). Wellesley.</li>
<li>Linear algebra and its applications by Gilbert Strang

<ul>
<li>lots of supplimentary material via MIT course page here:
<a href="https://github.com/mitmath/1806/blob/master/summaries.md">https://github.com/mitmath/1806/blob/master/summaries.md</a></li>
</ul></li>
<li>LA from an ODE perspective: Kapitula, T. (2015). Ordinary Differential Equations and
Linear Algebra. Society for Industrial and Applied Mathematics.</li>
</ul>

<h2 id="problems">Problems</h2>


<div class="notices question" >
  <div class="label">Question</div>
  <ol>
<li>Describe the intersection of the three planes $u+v+w+z = 6$, $u+w+z = 4$ and $u+w =
2$ (all in four-dimensional space). Is it a line or a point or a fourth equation that
leaves us with no solution. an empty set? What is the intersection if the fourth
plane $u = −1$ is included? Find a fourth equation that leaves us with no solution.</li>
</ol>

</div>



<details>
    <summary>Expand for solution</summary>
    <div class="notices solution" >
  <div class="label">Solution</div>
  <p>The intersection of the 3 planes is the 1d line $u + w = 2$, $v=2$ and $z=2$.
Introducing a fourth equation that does not intersect this line (e.g. $u + w = 3$)
leaves us with no solutions.</p>

</div>

</details>



<div class="notices question" >
  <div class="label">Question</div>
  <ol start="2">
<li>Sketch or plot in Python these three lines and decide if the equations are solvable:
3 by 2 system $x + 2y = 2$, $x − y = 2$, and $y = 1$. What happens if all right-hand
sides are zero? Is there any nonzero choice of right- hand sides that allows the
three lines to intersect at the same point?</li>
</ol>

</div>



<details>
    <summary>Expand for solution</summary>
    <div class="notices solution" >
  <div class="label">Solution</div>
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pylab <span style="color:#f92672">as</span> plt

x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">100</span>)

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">plot_lines</span>(b1, b2, b3):
    y1 <span style="color:#f92672">=</span> (b1 <span style="color:#f92672">-</span> x) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
    y2 <span style="color:#f92672">=</span> x <span style="color:#f92672">-</span> b2
    y3 <span style="color:#f92672">=</span> b3 <span style="color:#f92672">*</span> np<span style="color:#f92672">.</span>ones_like(x)
    plt<span style="color:#f92672">.</span>plot(x, y1)
    plt<span style="color:#f92672">.</span>plot(x, y2)
    plt<span style="color:#f92672">.</span>plot(x, y3)
    plt<span style="color:#f92672">.</span>show()


plot_lines(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">1</span>)
plot_lines(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)
plot_lines(<span style="color:#ae81ff">2</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>)</code></pre></div>
</div>

</details>



<div class="notices question" >
  <div class="label">Question</div>
  <ol start="3">
<li>Write a Python function that takes in a $3 \times 3$ upper triangular matrix $A$
represented as an <code>ndarray</code>, and a rhs vector $b$, and solves the equation $A x = b$.
i.e. the function will solve the following triangular system for $x = (x_1, x_2,
x_3)$:</li>
</ol>

<p><span  class="math">\[
\begin{aligned}
A_{11} x_1 + A_{12} x_2 + A_{13} x_3 &= b_1, \\
A_{22} x_2 + A_{23} x_3 &= b_2, \\
A_{33} x_3 &= b_3
\end{aligned}
\]</span></p>

<p>Generalise this function to a $n \times n$ triangular matrix input.</p>

</div>



<details>
    <summary>Expand for solution</summary>
    <div class="notices solution" >
  <div class="label">Solution</div>
  <div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">solve_triangular</span>(A, b):
    n <span style="color:#f92672">=</span> len(b)
    x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>empty_like(b)
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
        x[i] <span style="color:#f92672">=</span> b[i]
        <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(n<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, i, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
            x[i] <span style="color:#f92672">-=</span> A[i, j] <span style="color:#f92672">*</span> x[j]
        x[i] <span style="color:#f92672">/=</span> A[i, i]
    <span style="color:#66d9ef">return</span> x

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">random_upper_triangular</span>(n):
    R <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(n, n)
    A <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros((n, n))
    triu <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>triu_indices(n)
    A[triu] <span style="color:#f92672">=</span> R[triu]
    <span style="color:#66d9ef">return</span> A

As <span style="color:#f92672">=</span> [
    np<span style="color:#f92672">.</span>array([[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>]]),
    random_upper_triangular(<span style="color:#ae81ff">3</span>),
    random_upper_triangular(<span style="color:#ae81ff">4</span>),
    random_upper_triangular(<span style="color:#ae81ff">5</span>),
    random_upper_triangular(<span style="color:#ae81ff">6</span>),
]

bs <span style="color:#f92672">=</span> [
    np<span style="color:#f92672">.</span>array([<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>]),
    np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">3</span>),
    np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">4</span>),
    np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">5</span>),
    np<span style="color:#f92672">.</span>random<span style="color:#f92672">.</span>rand(<span style="color:#ae81ff">6</span>),
]

<span style="color:#66d9ef">for</span> A, b <span style="color:#f92672">in</span> zip(As, bs):
    x_scipy <span style="color:#f92672">=</span> scipy<span style="color:#f92672">.</span>linalg<span style="color:#f92672">.</span>solve_triangular(A, b)
    x_mine <span style="color:#f92672">=</span> solve_triangular(A, b)
    np<span style="color:#f92672">.</span>testing<span style="color:#f92672">.</span>assert_almost_equal(x_scipy, x_mine)</code></pre></div>
</div>

</details>



<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/scientific-computing/unit_1_linear_algebra/" title="Direct Solvers and Matrix Decompositions"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/scientific-computing/unit_1_linear_algebra/02-gaussian-elimination/" title="Gaussian Elimination" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/scientific-computing/js/clipboard.min.js?1609437715"></script>
    <script src="/scientific-computing/js/perfect-scrollbar.min.js?1609437715"></script>
    <script src="/scientific-computing/js/perfect-scrollbar.jquery.min.js?1609437715"></script>
    <script src="/scientific-computing/js/jquery.sticky.js?1609437715"></script>
    <script src="/scientific-computing/js/featherlight.min.js?1609437715"></script>
    <script src="/scientific-computing/js/highlight.pack.js?1609437715"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/scientific-computing/js/modernizr.custom-3.6.0.js?1609437715"></script>
    <script src="/scientific-computing/js/learn.js?1609437715"></script>
    <script src="/scientific-computing/js/hugo-learn.js?1609437715"></script>
    
    

  </body>
</html>

